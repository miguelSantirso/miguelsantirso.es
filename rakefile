$host = 'pncil.com'
$username = 'miguelsantirso'
$remote_path = 'miguelsantirso.es'

desc "Publishes the site!"
task :publish do
    require 'net/sftp'
    require 'highline/import'
    
    password = ask("Enter password for host '#{$host}':") { |q| q.echo = "x" }
    
    Net::SSH.start(
        $host, 
        $username,
        :password => password, 
        :auth_methods => ['password'],
        :compression => 'zlib') do |ssh|
        
        ssh.exec! "cd #{$remote_path}";
        ssh.exec! "git checkout master";
        ssh.exec! "git clean -d -x -f";
        ssh.exec! "git pull";
    
    end # Net::SSH.start

end


desc "Installs the required gems"
task :first_time do
    sh 'gem install rakefile'
    sh 'gem install net-ssh'
end